# Índices compuestos requeridos para Firebase

Para optimizar las consultas de Firebase, es necesario crear los siguientes índices compuestos en Firebase Console:

## Índice para getNextAvailableDate()

Campo 1: cabinType (Ascendente)
Campo 2: checkOut (Ascendente)

Este índice permite consultar por tipo de cabaña y ordenar por fecha de salida simultáneamente.

## Cómo crear los índices:

1. Ve a Firebase Console > Firestore Database > Índices
2. Haz clic en "Crear índice"
3. Selecciona la colección: reservations
4. Agrega los campos en el orden especificado
5. Haz clic en "Crear"

Alternativamente, Firebase creará automáticamente estos índices cuando se ejecuten las consultas por primera vez y aparezca el enlace de error en la consola.

## Actualización - Consultas optimizadas para datos heterogéneos

TODAS las funciones de lectura (getAllReservations, getTodayArrivals, etc.) han sido actualizadas para:
- Obtener todos los documentos sin orderBy ni where complejos para evitar errores de tipo mixto
- Normalizar fechas en el cliente (Timestamp -> YYYY-MM-DD string)
- Filtrar y ordenar localmente después de la normalización

Esto garantiza que los datos se muestren correctamente incluso si la colección contiene fechas en formatos mixtos (Timestamp vs string).

Una vez que se ejecute la migración opcional para homogeneizar todos los checkIn/checkOut como strings YYYY-MM-DD, 
se podrán rehabilitar las consultas eficientes con índices.